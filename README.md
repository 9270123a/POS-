# 專案概述

1.使用 C# WinForms 開發  
2.實現了點餐、計價、折扣等核心功能  
3.採用了多種設計模式來確保系統的可擴展性和可維護性


![image](https://github.com/user-attachments/assets/9fa78c1c-5a84-498d-83bd-792440ae92aa)


# 系統架構思維
### 我想從我整個專案思維的轉換過程來介紹我的專案  

目標 : 
打造一個好維護好擴展的Clean Code架構
我的目標並不單純只是完成這個應用程式，在不改變任何一行程式碼的情況下，可以任意抽換菜單內容，任意更改折扣的商業邏輯以及折扣算法。


在一開始的思維，很直觀的會想到前後端分離

但這樣的架構，會有幾個問題

只有一個後端，顯示邏輯跟折扣邏輯混再一起，代表顯示跟折扣是綁定，當需要改變的時候，全部都要改，擴張跟維護性都很差，且違反開放封閉原則。

![image](https://github.com/user-attachments/assets/4acbd7b5-7a15-4f3b-b3fc-01bf6c3982f9)



### 引入觀察者模式

所以在在一開始我將顯示跟後端分開，我說明一下沒有分開的話會怎樣  


在不用觀察者模式的寫法會是ORDER呼叫的方式讓Display去做顯示，但這樣的寫法會出現  
1.當顯示的邏輯有改變時，比如說要加入新的圖表，他可能要傳遞進不同的參數，違反開放封閉原則，再改display的時候也要改動order模組  
2.當今天要在多個地方顯示折扣，order可能要思考呼叫順序等。

但今天使用觀察者模式會完全解決這兩個問題，他會在order有將資料做出更動的時候，display會自動監聽到然後做出前端的渲染。
所以我在這邊解決傳統架構的顯示跟後端問題，將邏輯的職責獨立，並將他們完全解耦合。在後面也會知道這個寫法的好處。

![image](https://github.com/user-attachments/assets/e325c0b8-849b-4492-a045-8719f9932b4b)



### 引入簡單工廠設計模式

但考慮到真實世界餐廳折扣變化快的問題，不可能每次跟改就去改整個後端  
，所以引入簡單工廠來做折扣集中管理。  

優點:DiscountFactory，集中管理所有折扣類的創建 根據類型字串返回對應的折扣對象 隱藏了具體類的實例化細節，創建新的子類在工廠添加對應的 case，不需要修改現有的代碼，解決原本將ORDER折扣放在一起的後端問題

缺點: 雖然這樣的架構可以需要增添新折扣的時，只需要增加新的Discount 並且在Factory中多新增一個選項，即可完成擴充。
但這樣的架構其實隱含一個缺點。 那就是以POS機的折扣促銷來說，每天或每周可能都會有各種不同的折扣以及優惠活動，因此在這樣的情況下反覆的為每一個折扣都增添一個類別顯然是不合理的，同時也違反了開放封閉原則
因此在這樣的架構下，我開始嘗試導入了策略模式，將大宗的折扣促銷演算法列舉出來，並且加以實作，透過這樣的方式，即使有新的折扣活動需要添加，程式碼也不在需要改動，因為套用的演算法其實都是同一個

![image](https://github.com/user-attachments/assets/0db5a147-7131-4243-a329-ec2089c8e8a3)





### 最後引入策略模式  

因為簡單工廠他創建類別需要事先寫好(硬編碼概念)，而折扣模式則是可以動態傳入參數，所以她更加適配json檔案  
因此在這樣的架構下，我在改變不管是折扣還是餐點。我不再需要更改程式碼，所有的餐點資料全部來自json檔案，我們只需要維護json schema 就可以在不改變程式碼以及完全不編譯的情況下成功重新抽換菜單以及更改折扣的演算法    
此外，再導入策略模式之後，我還同時使用Reflection(反射)的方式，透過反射我們甚至不需要像簡單工廠一樣寫出各種的switch case 來去選擇不同的折扣，完全符合開放封閉
而是當使用者下拉選單選定折扣之後，我們就可以取得該折扣的演算法類別，並透過反射方式自動生成該折扣算法，來進行計算。 透過這樣的方式，一樣只需要維護json schema 就能夠做到全站統一更換折扣促銷活動的算法，而不需要改任何一樣程式碼甚至是編譯他。

![image](https://github.com/user-attachments/assets/6098df1f-d501-4c4d-bc9b-ee4653df8d15)



### 自定義json檔案

![image](https://github.com/user-attachments/assets/ab5baf6a-f34e-4a4b-89b4-f2d0cd8ebd7b)



![image](https://github.com/user-attachments/assets/98b85653-4333-47cb-946f-ffd74c57a713)



POS系統架構演進與創新
關鍵改進步驟 

1.一開始是顯示與業務邏輯強耦合，應用觀察者模式解決顯示耦合  
2.折扣需要常改動，且沒有封裝細節，引入簡單工廠初步解決折扣管理  
3.但發現說簡單工廠更適合固定的東西，在餐廳折扣這個主題上折扣和參數變化量太大。最終採用策略模式實現完全配置驅動    

創新點：完全配置驅動的設計 
1.JSON驅動的菜單系統  
2.無需數據庫的輕量級設計  
3.只需維護JSON schema  

結論
這個專案實現了一個“配置驅動”系統，不僅解決了傳統POS系統的擴展性和維護性問題，且他個無需數據庫、純配置驅動的解決方案。通過觀察者模式、策略模式和反射機制的結合，實現了業務邏輯的完全外部化，使得系統能夠以最小的維護成本適應各種業務場景的變化。這種設計方案特別適合快速部署、頻繁更改業務規則的餐飲行業，為POS系統的設計提供了一個解決方案。



